 
# New Relic Alerts

New Relic Alerts is a place to manage alerting configuration as well as to see and respond to incidents detected.

[[_TOC_]]

## Basic workflow
![Alt text](graphics/alert-policy-architecture.png?raw=true "Alert Policy Architecture")

A typical process for creating an alert policy and an associated alert condition:
* Create an alert policy. When you create a policy:
    * Give it a meaningful name. For example: the group or team's name, or the set of resources or services the alert policy targets.
    * Set the incident preference, which determines how violations become incidents.
    * Set notification channels.
* Create an alert condition that will be attached to that policy. Steps involved in creating a condition include:
    * Choose a data source that will be monitored (for example, an APM metric or a NRQL query).
    * Set the thresholds that define what behavior will produce a violation.

## Specify when New Relic creates incidents 

New Relic Alerts creates *incident* record with detailed information to help respond efficiently. An incident is a collection of one or more violations. It includes all of the open and close timestamps for each violation.

Notifications are sent to notification channel(s) on the policy when an incident opens, if and when an incident is acknowledged, and when an incident closes.
 
 ![Alt text](graphics/incident-preference.png?raw=true "Alert Incident Preference")

### Incident preference options

- By policy (default)
    * Only one incident will be open at a time for the entire policy. Fewest number of alert notifications.
    * Requires immediate action and closing the incidents to be effective.

- By condition	
    * One incident will be open at a time for each condition in your policy. More alert notifications.
    * Useful for policies containing conditions that focus on entities that perform the same job; for example, hosts that all serve the same application(s).

- By condition and entity(Choosing)	
    * An incident will be created for every violation in your policy. Most alert notifications.
    * Useful if you need to be notified of every violation or if you have an external system where you want to send alert notifications

## New Relic Alert conditions 

<!--### Configuring alert conditions for APM applications -->

Use the following examples as best practice for getting started with alert conditions for applications instrumented with New Relic APM.

* Threshold condition on web transaction time and Apdex: Triggers an alert when your application isn’t meeting web transaction time or Apdex thresholds. Using Apdex, we can classify traffic performance into three buckets: Satisfied, Tolerating, and Frustrated. New Relic computes Apdex every two minutes for the entire application and for every Key Transaction that has been configured. All you have to do get started using Apdex is set your response time threshold, or “T value.” New Relic recommends setting your T value to the 85 percentile based on analysis done.

* Threshold condition on error percentage: Triggers an alert for increases in your application’s error percentage; for APM applications, this threshold should be 0.

* Baseline response time and throughput alerts for key external requests: Triggers alerts if upstream service providers (e.g., payment gateways) are causing latency.

## Notification Channels
In New Relic Alert, we can attach multiple notification channels to alert policies. It provides fast and consistent way teams to be notified about incidents. Using webhook we have configured slack channels to receive notifications.

## Anomaly / Passive Detection

The toolset allows for some anomaly or baseline based passive detection. Rather than determining what means healthy for your applications directly you can ask [New Relic One](https://one.newrelic.com/) to inform you when it moves too far away from what it considers normal behavior. As data and time increases the sensitivity gets fine tuned and more accurate.

This can be done as part of NR One's [Applied Intelligence](https://one.newrelic.com/launcher/nrai.launcher) plugin. 

1. From Applied Intelligence, visit *Configuration*
2. Select the alert group, ie prod or non-prod alerts
3. Search and Select new entities (such as a new production environment)
4. Save

Currently, NR One does not support creating label based Anomaly alerting - if you're using this feature please come back to add new entities as you add applications or environments to existing applications.

## Inherent challenges

* *Sensitivity*. Overly sensitive systems cause excessive false positive alerts, while less sensitive systems can miss issues and have false negatives. Determining the correct alerting threshold requires ongoing tuning and refinement.
* *Fatigue*. The common approach to sensitivity is to be more conservative when setting up alerts, but this results in a more sensitive and noisy alerting system. If teams encounter too many false positives, they will begin to ignore alerts and miss real issues, defeating the purpose of an alerting system.
* *Maintenance*. Systems grow and evolve quickly, but we are often slow to alerting policies. This leads to an alerting strategy that is simultaneously filled with outdated policy deadwood and gaps where teams aren’t providing coverage to newer changes in their systems.

## Reference links

* https://docs.newrelic.com/docs/alerts/new-relic-alerts/getting-started/alerts-best-practices
* https://docs.newrelic.com/docs/alerts/new-relic-alerts/configuring-alert-policies/specify-when-new-relic-creates-incidents
* https://blog.newrelic.com/product-news/best-practices-new-relic-alert-conditions/
* https://learn.newrelic.com/alerting-course


